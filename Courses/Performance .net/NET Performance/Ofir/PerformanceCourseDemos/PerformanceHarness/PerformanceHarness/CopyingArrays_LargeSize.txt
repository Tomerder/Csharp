using System;
using System.Runtime.InteropServices;
using PerformanceHarness;

public static class Arrays_Large
{
	public static byte[] First = new byte[4*1048576];
	public static byte[] Second = new byte[4*1048576];

	static Arrays_Large()
	{
		Random random = new Random();
		for (int i = 0; i < First.Length; ++i)
			First[i] = (byte) random.Next(0, 255);
	}
}

//[MeasurableClass]
public static class NaiveCopyTest_Large
{
	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			for (int i = 0; i < Arrays_Large.First.Length; ++i)
				Arrays_Large.Second[i] = Arrays_Large.First[i];
		}
	}
}

[MeasurableClass]
public static class FixedCopyTest_Large
{
	[MeasurableMethod]
	static unsafe void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			fixed (byte* p1 = &Arrays_Large.First[0])
			fixed (byte* p2 = &Arrays_Large.Second[0])
			{
				long* pSrc = (long*)p1;
				long* pDst = (long*)p2;
				int len = Arrays_Large.First.Length / (sizeof(long) * 8);
				for (int i = 0; i < len; ++i)
				{
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
				}
			}
		}
	}
}

[MeasurableClass]
public static class ArrayCopyTest_Large
{
	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			Array.Copy(Arrays_Large.First, Arrays_Large.Second, Arrays_Large.First.Length);
		}
	}
}

[MeasurableClass]
public static class BlockCopyTest_Large
{
	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			Buffer.BlockCopy(Arrays_Large.First, 0, Arrays_Large.Second, 0, Arrays_Large.First.Length);
		}
	}
}

[MeasurableClass]
public static class IntopCopyTest_Large
{
	[DllImport("MSVCRT.DLL")]
	private static extern void memcpy(byte[] pDst, byte[] pSrc, int count);

	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			memcpy(Arrays_Large.First, Arrays_Large.Second, Arrays_Large.First.Length);
		}
	}
}

//[MeasurableClass]
public static class Ipps5CopyTest_Large
{
	[DllImport("IPPS.DLL")]
	private static extern IntPtr ippsCopy_8u(byte[] pDst, byte[] pSrc, int count);

	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			ippsCopy_8u(Arrays_Large.First, Arrays_Large.Second, Arrays_Large.First.Length);
		}
	}
}