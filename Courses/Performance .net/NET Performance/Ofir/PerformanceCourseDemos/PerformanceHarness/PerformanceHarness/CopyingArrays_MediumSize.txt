using System;
using System.Runtime.InteropServices;
using PerformanceHarness;

public static class Arrays_Medium
{
	public static byte[] First = new byte[65536];
	public static byte[] Second = new byte[65536];

	static Arrays_Medium()
	{
		Random random = new Random();
		for (int i = 0; i < First.Length; ++i)
			First[i] = (byte) random.Next(0, 255);
	}
}

//[MeasurableClass]
public static class NaiveCopyTest_Medium
{
	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			for (int i = 0; i < Arrays_Medium.First.Length; ++i)
				Arrays_Medium.Second[i] = Arrays_Medium.First[i];
		}
	}
}

[MeasurableClass]
public static class FixedCopyTest_Medium
{
	[MeasurableMethod]
	static unsafe void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			fixed (byte* p1 = &Arrays_Medium.First[0])
			fixed (byte* p2 = &Arrays_Medium.Second[0])
			{
				long* pSrc = (long*)p1;
				long* pDst = (long*)p2;
				int len = Arrays_Medium.First.Length / (sizeof(long) * 8);
				for (int i = 0; i < len; ++i)
				{
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
					*pSrc++ = *pDst++;
				}
			}
		}
	}
}

[MeasurableClass]
public static class ArrayCopyTest_Medium
{
	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			Array.Copy(Arrays_Medium.First, Arrays_Medium.Second, Arrays_Medium.First.Length);
		}
	}
}

[MeasurableClass]
public static class BlockCopyTest_Medium
{
	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			Buffer.BlockCopy(Arrays_Medium.First, 0, Arrays_Medium.Second, 0, Arrays_Medium.First.Length);
		}
	}
}

[MeasurableClass]
public static class IntopCopyTest_Medium
{
	[DllImport("MSVCRT.DLL")]
	private static extern void memcpy(byte[] pDst, byte[] pSrc, int count);

	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			memcpy(Arrays_Medium.First, Arrays_Medium.Second, Arrays_Medium.First.Length);
		}
	}
}

//[MeasurableClass]
public static class Ipps5CopyTest_Medium
{
	[DllImport("IPPS.DLL")]
	private static extern IntPtr ippsCopy_8u(byte[] pDst, byte[] pSrc, int count);

	[MeasurableMethod]
	static void Measure()
	{
		for (int __i = 0; __i < %NUMBER_OF_ITERATIONS%; ++__i)
		{
			ippsCopy_8u(Arrays_Medium.First, Arrays_Medium.Second, Arrays_Medium.First.Length);
		}
	}
}